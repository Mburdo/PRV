{"id":"PRV-pcy","title":"SPIKE-002 corpus + scoring rubric","description":"Build corpus + methodology + scoring rubric for SPIKE-002; produce ~50 commit↔session pairs and step-ladder evaluation plan/results. Also update planning docs to support v1 minimal live overlay (provisional matching) and reflect time-prior scoring.","status":"closed","priority":1,"issue_type":"task","assignee":"LilacDog","estimated_minutes":180,"created_at":"2025-12-28T16:19:33.957864-05:00","updated_at":"2025-12-28T18:50:44.471594-05:00","closed_at":"2025-12-28T18:50:44.471594-05:00"}
{"id":"PRV-u0f","title":"Phase 0: Foundation","description":"Establish build system, CASS integration, and basic data flow. Exit criteria: cargo build produces prv binary, prv debug cass shows session count, unit tests pass for code block parser.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-27T22:44:07.432156-05:00","updated_at":"2025-12-28T12:22:43.826278-05:00","closed_at":"2025-12-28T12:22:43.826278-05:00"}
{"id":"PRV-u0f.1","title":"phase0.1: Cargo workspace setup","description":"Create Rust cargo workspace structure:\n- Root Cargo.toml with workspace members: prv, prv-core, prv-cass\n- .gitignore for Rust artifacts\n- crates/ directory with subdirectories for each crate\n\nFiles:\n- Cargo.toml (workspace root)\n- .gitignore\n- crates/prv/Cargo.toml\n- crates/prv-core/Cargo.toml  \n- crates/prv-cass/Cargo.toml\n\nVerification: cargo build succeeds (even if crates are empty stubs)","status":"closed","priority":1,"issue_type":"task","assignee":"BlackCat","created_at":"2025-12-27T22:44:21.587895-05:00","updated_at":"2025-12-28T12:15:05.385983-05:00","closed_at":"2025-12-28T12:15:05.385983-05:00","dependencies":[{"issue_id":"PRV-u0f.1","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:44:21.588581-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.2","title":"phase0.2: prv-core CodeBlock struct","description":"## North Star\nContext tracing for code. Trace any line back to its origin, the reasoning behind it, and alternatives rejected.\n\n**This bead:** Foundation data structure for extracted code blocks.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**File:** `crates/prv-core/src/code_block.rs`\n\n```rust\n#[derive(Debug, Clone, PartialEq)]\npub struct CodeBlock {\n    pub content: String,\n    pub language: Option\u003cString\u003e,\n    pub source_line: usize,\n}\n\nimpl CodeBlock {\n    pub fn new(content: String, language: Option\u003cString\u003e, source_line: usize) -\u003e Self {\n        Self { content, language, source_line }\n    }\n}\n```\n\n**File:** `crates/prv-core/src/lib.rs`\n```rust\npub mod code_block;\npub use code_block::CodeBlock;\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_code_block_new() {\n        let block = CodeBlock::new(\"fn main() {}\".to_string(), Some(\"rust\".to_string()), 10);\n        assert_eq!(block.content, \"fn main() {}\");\n        assert_eq!(block.language, Some(\"rust\".to_string()));\n        assert_eq!(block.source_line, 10);\n    }\n\n    #[test]\n    fn test_code_block_no_language() {\n        let block = CodeBlock::new(\"code\".to_string(), None, 1);\n        assert!(block.language.is_none());\n    }\n\n    #[test]\n    fn test_code_block_equality() {\n        let a = CodeBlock::new(\"x\".to_string(), None, 1);\n        let b = CodeBlock::new(\"x\".to_string(), None, 1);\n        assert_eq!(a, b);\n    }\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `cargo build` succeeds\n- [ ] `cargo test` passes (3 tests)\n- [ ] CodeBlock is public and usable from prv-core","status":"closed","priority":1,"issue_type":"task","assignee":"TrackA","created_at":"2025-12-27T22:44:34.800209-05:00","updated_at":"2025-12-28T12:17:16.447043-05:00","closed_at":"2025-12-28T12:17:16.447043-05:00","dependencies":[{"issue_id":"PRV-u0f.2","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:44:34.800817-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.2","depends_on_id":"PRV-u0f.1","type":"blocks","created_at":"2025-12-27T22:46:44.848477-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.3","title":"phase0.3: Code block parser","description":"## North Star\nContext tracing for code. PRV extracts code blocks from CASS messages for fingerprinting against commits.\n\n**This bead:** Core parsing logic to extract code from AI session transcripts.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**File:** `crates/prv-core/src/code_block.rs`\n\n**Dependencies:** Add `regex = \"1\"` to `crates/prv-core/Cargo.toml`\n\n```rust\nuse regex::Regex;\n\n/// Extract all code blocks from markdown-style text\npub fn extract_code_blocks(text: \u0026str) -\u003e Vec\u003cCodeBlock\u003e {\n    let mut blocks = Vec::new();\n    \n    // 1. Triple backtick blocks: ```lang\\ncode\\n```\n    let re = Regex::new(r\"```(\\w*)\\n([\\s\\S]*?)```\").unwrap();\n    for (line_num, cap) in re.captures_iter(text).enumerate() {\n        let lang = cap.get(1).map(|m| m.as_str().to_string()).filter(|s| !s.is_empty());\n        let content = cap.get(2).map(|m| m.as_str().to_string()).unwrap_or_default();\n        blocks.push(CodeBlock::new(content, lang, line_num));\n    }\n    \n    // 2. 4-space indented blocks (simplified - consecutive indented lines)\n    // 3. Diff format (+lines)\n    \n    blocks\n}\n```\n\n**Note:** Full implementation handles edge cases. This shows the pattern.\n\n---\n\n## Tests (Write First)\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_triple_backtick_basic() {\n        let text = \"```\\nfn main() {}\\n```\";\n        let blocks = extract_code_blocks(text);\n        assert_eq!(blocks.len(), 1);\n        assert_eq!(blocks[0].content, \"fn main() {}\\n\");\n    }\n\n    #[test]\n    fn test_triple_backtick_with_language() {\n        let text = \"```rust\\nlet x = 1;\\n```\";\n        let blocks = extract_code_blocks(text);\n        assert_eq!(blocks[0].language, Some(\"rust\".to_string()));\n    }\n\n    #[test]\n    fn test_multiple_blocks() {\n        let text = \"```python\\nprint(1)\\n```\\ntext\\n```js\\nconsole.log(1)\\n```\";\n        let blocks = extract_code_blocks(text);\n        assert_eq!(blocks.len(), 2);\n    }\n\n    #[test]\n    fn test_empty_input() {\n        let blocks = extract_code_blocks(\"\");\n        assert!(blocks.is_empty());\n    }\n\n    #[test]\n    fn test_no_code_blocks() {\n        let blocks = extract_code_blocks(\"just plain text\");\n        assert!(blocks.is_empty());\n    }\n\n    #[test]\n    fn test_unclosed_block() {\n        let text = \"```rust\\nlet x = 1;\";\n        let blocks = extract_code_blocks(text);\n        // Should not crash, may return 0 or partial\n        assert!(blocks.len() \u003c= 1);\n    }\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `cargo build` succeeds\n- [ ] `cargo test` passes (6 tests)\n- [ ] Handles malformed input without panic","status":"closed","priority":1,"issue_type":"task","assignee":"TrackA","created_at":"2025-12-27T22:44:49.346901-05:00","updated_at":"2025-12-28T12:18:24.229095-05:00","closed_at":"2025-12-28T12:18:24.229095-05:00","dependencies":[{"issue_id":"PRV-u0f.3","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:44:49.347939-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.3","depends_on_id":"PRV-u0f.2","type":"blocks","created_at":"2025-12-27T22:46:49.990514-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.4","title":"phase0.4: Code block parser tests","description":"Unit tests for code block parser:\n\nFile: crates/prv-core/src/code_block.rs (inline tests) or tests/code_block_test.rs\n\nTests:\n1. test_triple_backtick_basic - extracts simple code block\n2. test_triple_backtick_with_language - extracts language tag\n3. test_multiple_blocks - extracts all blocks from text\n4. test_4space_indent - extracts indented code\n5. test_diff_format - extracts + lines from unified diff\n6. test_malformed_unclosed - handles unclosed block gracefully\n7. test_nested_blocks - handles nested backticks\n8. test_empty_input - returns empty vec\n\nVerification: cargo test passes","status":"closed","priority":1,"issue_type":"task","assignee":"TrackA","created_at":"2025-12-27T22:45:04.049102-05:00","updated_at":"2025-12-28T12:19:54.973711-05:00","closed_at":"2025-12-28T12:19:54.973711-05:00","dependencies":[{"issue_id":"PRV-u0f.4","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:45:04.049992-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.4","depends_on_id":"PRV-u0f.3","type":"blocks","created_at":"2025-12-27T22:46:55.133709-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.5","title":"phase0.5: prv-cass models","description":"## North Star\nContext tracing for code. PRV reads session data from CASS SQLite to correlate with git commits.\n\n**This bead:** Data models matching CASS database schema.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**File:** `crates/prv-cass/src/models.rs`\n\n```rust\n#[derive(Debug, Clone)]\npub struct Workspace {\n    pub id: i64,\n    pub path: String,\n}\n\n#[derive(Debug, Clone)]\npub struct Conversation {\n    pub id: i64,\n    pub workspace_id: i64,\n    pub started_at: i64,      // Unix ms\n    pub ended_at: Option\u003ci64\u003e,\n    pub title: Option\u003cString\u003e,\n    pub source_path: Option\u003cString\u003e,\n}\n\n#[derive(Debug, Clone)]\npub struct Message {\n    pub id: i64,\n    pub conversation_id: i64,\n    pub role: String,         // \"user\" or \"assistant\"\n    pub content: String,\n    pub created_at: i64,      // Unix ms\n}\n```\n\n**File:** `crates/prv-cass/src/lib.rs`\n```rust\npub mod models;\npub mod db;\npub mod workspace;\n\npub use models::{Workspace, Conversation, Message};\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_workspace_creation() {\n        let ws = Workspace { id: 1, path: \"/home/user/project\".to_string() };\n        assert_eq!(ws.id, 1);\n    }\n\n    #[test]\n    fn test_conversation_optional_fields() {\n        let conv = Conversation {\n            id: 1, workspace_id: 1, started_at: 1000, ended_at: None,\n            title: None, source_path: None,\n        };\n        assert!(conv.ended_at.is_none());\n    }\n\n    #[test]\n    fn test_message_roles() {\n        let msg = Message {\n            id: 1, conversation_id: 1, role: \"assistant\".to_string(),\n            content: \"Hello\".to_string(), created_at: 1000,\n        };\n        assert_eq!(msg.role, \"assistant\");\n    }\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `cargo build` succeeds\n- [ ] Models match CASS schema (verified in SPIKE-001)\n- [ ] All structs derive Debug, Clone","status":"closed","priority":1,"issue_type":"task","assignee":"TrackB","created_at":"2025-12-27T22:45:16.91049-05:00","updated_at":"2025-12-28T12:17:22.440121-05:00","closed_at":"2025-12-28T12:17:22.440121-05:00","dependencies":[{"issue_id":"PRV-u0f.5","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:45:16.911155-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.5","depends_on_id":"PRV-u0f.1","type":"blocks","created_at":"2025-12-27T22:47:00.274803-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.6","title":"phase0.6: CASS database connection","description":"## North Star\nContext tracing for code. PRV reads from CASS SQLite database (ADR-006).\n\n**This bead:** Database connection and query layer for CASS.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**Dependencies:** Add to `crates/prv-cass/Cargo.toml`:\n```toml\nrusqlite = { version = \"0.31\", features = [\"bundled\"] }\nanyhow = \"1\"\ndirs = \"5\"\n```\n\n**File:** `crates/prv-cass/src/db.rs`\n\n```rust\nuse anyhow::{Result, Context};\nuse rusqlite::Connection;\nuse crate::models::{Workspace, Conversation, Message};\n\npub struct CassDb {\n    conn: Connection,\n}\n\nimpl CassDb {\n    /// Open CASS database at default location\n    pub fn open() -\u003e Result\u003cSelf\u003e {\n        let path = Self::default_path()?;\n        let conn = Connection::open(\u0026path)\n            .with_context(|| format\\!(\"Failed to open CASS db at {:?}\", path))?;\n        Ok(Self { conn })\n    }\n\n    fn default_path() -\u003e Result\u003cstd::path::PathBuf\u003e {\n        let support = dirs::data_dir()\n            .context(\"Could not find Application Support directory\")?;\n        Ok(support\n            .join(\"com.coding-agent-search.coding-agent-search\")\n            .join(\"agent_search.db\"))\n    }\n\n    pub fn session_count(\u0026self) -\u003e Result\u003ci64\u003e {\n        let count: i64 = self.conn.query_row(\n            \"SELECT COUNT(*) FROM conversations\", [], |row| row.get(0)\n        )?;\n        Ok(count)\n    }\n\n    pub fn workspaces(\u0026self) -\u003e Result\u003cVec\u003cWorkspace\u003e\u003e {\n        let mut stmt = self.conn.prepare(\"SELECT id, path FROM workspaces\")?;\n        let rows = stmt.query_map([], |row| {\n            Ok(Workspace { id: row.get(0)?, path: row.get(1)? })\n        })?;\n        rows.collect::\u003cResult\u003cVec\u003c_\u003e, _\u003e\u003e().map_err(Into::into)\n    }\n}\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n\n    #[test]\n    fn test_default_path_exists() {\n        // Just verify path construction doesn't panic\n        let result = CassDb::default_path();\n        assert\\!(result.is_ok());\n    }\n\n    #[test]\n    fn test_open_missing_db() {\n        // If CASS not installed, should get clear error\n        let result = CassDb::open();\n        // Either succeeds or fails with context\n        match result {\n            Ok(_) =\u003e (), // CASS installed\n            Err(e) =\u003e assert\\!(e.to_string().contains(\"CASS\") || e.to_string().contains(\"agent_search\")),\n        }\n    }\n\n    // Integration test (requires CASS):\n    #[test]\n    #[ignore] // Run with: cargo test -- --ignored\n    fn test_session_count() {\n        let db = CassDb::open().unwrap();\n        let count = db.session_count().unwrap();\n        assert\\!(count \u003e= 0);\n    }\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `cargo build` succeeds\n- [ ] Clear error message if CASS not installed\n- [ ] `cargo test -- --ignored` passes with CASS present","status":"closed","priority":1,"issue_type":"task","assignee":"TrackB","created_at":"2025-12-27T22:45:31.642545-05:00","updated_at":"2025-12-28T12:18:35.120844-05:00","closed_at":"2025-12-28T12:18:35.120844-05:00","dependencies":[{"issue_id":"PRV-u0f.6","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:45:31.643222-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.6","depends_on_id":"PRV-u0f.5","type":"blocks","created_at":"2025-12-27T22:47:05.398218-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.7","title":"phase0.7: Workspace-repo mapping","description":"## North Star\nContext tracing for code. PRV maps git repos to CASS workspaces (REQ-004).\n\n**This bead:** Find which CASS workspace matches a git repository path.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**File:** `crates/prv-cass/src/workspace.rs`\n\n```rust\nuse std::path::Path;\nuse anyhow::Result;\nuse crate::{CassDb, Workspace};\n\n/// Find CASS workspace matching a git repo path\npub fn find_workspace_for_repo(db: \u0026CassDb, repo_path: \u0026Path) -\u003e Result\u003cOption\u003cWorkspace\u003e\u003e {\n    let canonical = repo_path.canonicalize()?;\n    let repo_str = canonical.to_string_lossy();\n    \n    for ws in db.workspaces()? {\n        let ws_path = Path::new(\u0026ws.path);\n        if let Ok(ws_canonical) = ws_path.canonicalize() {\n            // Case-insensitive on macOS\n            #[cfg(target_os = \"macos\")]\n            let matches = ws_canonical.to_string_lossy().to_lowercase() \n                == repo_str.to_lowercase();\n            \n            #[cfg(not(target_os = \"macos\"))]\n            let matches = ws_canonical == canonical;\n            \n            if matches {\n                return Ok(Some(ws));\n            }\n        }\n    }\n    Ok(None)\n}\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n    use std::path::PathBuf;\n\n    #[test]\n    fn test_path_with_trailing_slash() {\n        let p1 = PathBuf::from(\"/foo/bar\");\n        let p2 = PathBuf::from(\"/foo/bar/\");\n        // canonicalize strips trailing slash\n    }\n\n    #[test]\n    #[ignore] // Requires CASS\n    fn test_find_workspace_real() {\n        let db = CassDb::open().unwrap();\n        let cwd = std::env::current_dir().unwrap();\n        let result = find_workspace_for_repo(\u0026db, \u0026cwd);\n        assert!(result.is_ok());\n    }\n\n    #[test]\n    fn test_nonexistent_path() {\n        let path = Path::new(\"/nonexistent/path/12345\");\n        assert!(path.canonicalize().is_err());\n    }\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] Handles trailing slashes\n- [ ] Handles symlinks (via canonicalize)\n- [ ] Case-insensitive on macOS\n- [ ] Returns None for unmatched paths (not error)","status":"closed","priority":1,"issue_type":"task","assignee":"TrackB","created_at":"2025-12-27T22:45:44.987758-05:00","updated_at":"2025-12-28T12:19:42.891644-05:00","closed_at":"2025-12-28T12:19:42.891644-05:00","dependencies":[{"issue_id":"PRV-u0f.7","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:45:44.988506-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.7","depends_on_id":"PRV-u0f.6","type":"blocks","created_at":"2025-12-27T22:47:10.52514-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.8","title":"phase0.8: CLI binary with clap","description":"## North Star\nContext tracing for code. LSP is primary interface (ADR-008), CLI is secondary.\n\n**This bead:** CLI entry point with clap argument parsing.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**Dependencies:** Add to `crates/prv/Cargo.toml`:\n```toml\nclap = { version = \"4\", features = [\"derive\"] }\nprv-core = { path = \"../prv-core\" }\nprv-cass = { path = \"../prv-cass\" }\nanyhow = \"1\"\n```\n\n**File:** `crates/prv/src/main.rs`\n\n```rust\nuse clap::{Parser, Subcommand};\nuse anyhow::Result;\n\n#[derive(Parser)]\n#[command(name = \"prv\")]\n#[command(version, about = \"Context tracing for code\")]\nstruct Cli {\n    #[command(subcommand)]\n    command: Option\u003cCommands\u003e,\n}\n\n#[derive(Subcommand)]\nenum Commands {\n    /// Debug utilities\n    Debug {\n        #[command(subcommand)]\n        debug_cmd: DebugCommands,\n    },\n}\n\n#[derive(Subcommand)]\nenum DebugCommands {\n    /// Show CASS database status\n    Cass,\n}\n\nfn main() -\u003e Result\u003c()\u003e {\n    let cli = Cli::parse();\n    \n    match cli.command {\n        Some(Commands::Debug { debug_cmd }) =\u003e match debug_cmd {\n            DebugCommands::Cass =\u003e {\n                println!(\"CASS debug (not yet implemented)\");\n            }\n        },\n        None =\u003e {\n            println!(\"prv: context tracing for code\");\n            println!(\"Run with --help for usage\");\n        }\n    }\n    \n    Ok(())\n}\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n#[test]\nfn test_cli_parses() {\n    use clap::CommandFactory;\n    Cli::command().debug_assert();\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `cargo build` produces `prv` binary\n- [ ] `prv --version` shows version\n- [ ] `prv --help` shows help with debug subcommand\n- [ ] `prv debug cass` runs (placeholder ok)","status":"closed","priority":1,"issue_type":"task","assignee":"TrackC","created_at":"2025-12-27T22:45:58.067236-05:00","updated_at":"2025-12-28T12:17:14.526882-05:00","closed_at":"2025-12-28T12:17:14.526882-05:00","dependencies":[{"issue_id":"PRV-u0f.8","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:45:58.067886-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.8","depends_on_id":"PRV-u0f.1","type":"blocks","created_at":"2025-12-27T22:47:15.64591-05:00","created_by":"burdo"}]}
{"id":"PRV-u0f.9","title":"phase0.9: prv debug cass command","description":"## North Star\nContext tracing for code. This command validates Phase 0 integration - CASS reading + code block parsing.\n\n**This bead:** Integration command that proves all Phase 0 components work together.\n\n---\n\n## Workflow\n**TDD:** Write tests first → Run (expect fail) → Implement → Run (expect pass)\n\n---\n\n## Specification\n\n**File:** `crates/prv/src/main.rs` (extend DebugCommands::Cass handler)\n\n```rust\nDebugCommands::Cass =\u003e {\n    use prv_cass::CassDb;\n    use prv_core::code_block::extract_code_blocks;\n    \n    match CassDb::open() {\n        Ok(db) =\u003e {\n            let count = db.session_count()?;\n            let workspaces = db.workspaces()?;\n            \n            println!(\"CASS Database Status\");\n            println!(\"====================\");\n            println!(\"Location: ~/Library/Application Support/.../agent_search.db\");\n            println!(\"Status: Connected\");\n            println!(\"Workspaces: {}\", workspaces.len());\n            println!(\"Sessions: {}\", count);\n            \n            // Sample code block extraction from recent message\n            if let Some(msg) = get_recent_message(\u0026db)? {\n                let blocks = extract_code_blocks(\u0026msg.content);\n                println!(\"\\nSample extraction ({} blocks from recent message):\", blocks.len());\n                if let Some(block) = blocks.first() {\n                    let preview = block.content.lines().take(3).collect::\u003cVec\u003c_\u003e\u003e().join(\"\\n\");\n                    println!(\"  Language: {:?}\", block.language);\n                    println!(\"  Preview:\\n    {}\", preview.replace(\"\\n\", \"\\n    \"));\n                }\n            }\n        }\n        Err(e) =\u003e {\n            eprintln!(\"CASS not available: {}\", e);\n            eprintln!(\"\\nIs CASS installed? See: https://github.com/...\");\n            std::process::exit(1);\n        }\n    }\n}\n```\n\n---\n\n## Tests (Write First)\n\n```rust\n// Integration test - requires CASS\n#[test]\n#[ignore]\nfn test_debug_cass_integration() {\n    use std::process::Command;\n    \n    let output = Command::new(\"cargo\")\n        .args([\"run\", \"--\", \"debug\", \"cass\"])\n        .output()\n        .expect(\"Failed to run prv\");\n    \n    let stdout = String::from_utf8_lossy(\u0026output.stdout);\n    \n    // Should either connect or show clear error\n    assert!(\n        stdout.contains(\"Connected\") || \n        stdout.contains(\"CASS not available\")\n    );\n}\n```\n\n---\n\n## Verification Checklist\n- [ ] Tests written and fail (no implementation yet)\n- [ ] `prv debug cass` shows connection status\n- [ ] Shows workspace and session counts\n- [ ] Extracts code blocks from sample message\n- [ ] Clear error if CASS not installed\n\n---\n\n## Exit Criteria (Phase 0 Complete)\nWhen this bead passes, Phase 0 is done:\n- [ ] Cargo workspace builds\n- [ ] CASS models defined\n- [ ] Database connection works\n- [ ] Code block parser works\n- [ ] Integration verified via this command","status":"closed","priority":1,"issue_type":"task","assignee":"BlackCat","created_at":"2025-12-27T22:46:13.58871-05:00","updated_at":"2025-12-28T12:22:38.586481-05:00","closed_at":"2025-12-28T12:22:38.586481-05:00","dependencies":[{"issue_id":"PRV-u0f.9","depends_on_id":"PRV-u0f","type":"parent-child","created_at":"2025-12-27T22:46:13.589353-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.9","depends_on_id":"PRV-u0f.3","type":"blocks","created_at":"2025-12-27T22:47:20.777889-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.9","depends_on_id":"PRV-u0f.7","type":"blocks","created_at":"2025-12-27T22:47:25.896613-05:00","created_by":"burdo"},{"issue_id":"PRV-u0f.9","depends_on_id":"PRV-u0f.8","type":"blocks","created_at":"2025-12-27T22:47:31.027248-05:00","created_by":"burdo"}]}
